generator client {
  provider = "prisma-client"
  output   = "../app/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

enum UserRole {
  USER
  ADMIN
}
enum Difficulty {
  EASY
  MEDIUM 
  HARD
}

model User {
  id    String     @id @default(uuid())
  clerkId String @unique
  email String  @unique
  role UserRole @default(USER)
  firstName  String
  lastName  String
  imageUrl String?

  Problem     Problem[]
  solvedProblems  ProblemSolved[]


  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([role])
}


model Problem {
    id    String     @id @default(uuid())
    title  String @unique
    description  String
    difficulty Difficulty
    tags    String[]

    userId    String
    examples   Json
    constraints    String
    hints   String?
    editorial    String?

    testCases     Json
    codeSnippets   Json
    referenceSolution   Json

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    user    User    @relation(fields: [userId],references: [id], onDelete: Cascade )
    solvedBy       ProblemSolved[]

    @@index([difficulty])


}

model ProblemSolved {
  id        String   @id @default(uuid())
  userId    String  
  problemId String   
  createdAt DateTime @default(now())
  
 
  user    User    @relation(fields: [userId], references: [id], onDelete: Cascade)
  problem Problem @relation(fields: [problemId], references: [id], onDelete: Cascade)




  @@unique([userId, problemId]) 
}